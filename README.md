# Underwater-image-generation
Generating underwater images using **Stable Diffusion**

This work proposes a method for automatically generating millions of underwater images using **Stable Diffusion**.
The steps are as follows:

1. Training Step
Train Stable Diffusion on real underwater images and their captions using LoRA. Captions are generated by the state-of-the-art image captioning model, BLIP2.
<p align="center">
  <img src="./output/train_stable_diffusion.jpg" />
</p>

2. Inference Step
A prompt is fed into the model with a prefix of "An underwater view of". The model generates an underwater image. The verification block check its suitability.
If it is not suitable, the image is regenerated with a different seed.
Verification block consists of BLIP2, which generate a caption of the generated image. Then it compares its cosine similarity with the input prompt.
If the similarity is lower than a threshold, the image is considered unsuitable.

<p align="center">
  <img src="./output/inference_stable_diffusion.jpg" />
</p>

## Results
An example generated from the prompt: **An underwater view of a pipe**
<p align="center">
  <img src="./output/pipe_underwater.jpg" />
</p>

